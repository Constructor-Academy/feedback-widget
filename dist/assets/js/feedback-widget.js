(function(e,t){typeof exports=="object"&&typeof module<"u"?t(require("/Users/cdreek/development/constructor/courses/FeedbackWidget/node_modules/react/jsx-runtime.js"),require("/Users/cdreek/development/constructor/courses/FeedbackWidget/node_modules/react/index.js"),require("/Users/cdreek/development/constructor/courses/FeedbackWidget/node_modules/react-dom/client.js"),require("/Users/cdreek/development/constructor/courses/FeedbackWidget/node_modules/axios/index.js")):typeof define=="function"&&define.amd?define(["/Users/cdreek/development/constructor/courses/FeedbackWidget/node_modules/react/jsx-runtime.js","/Users/cdreek/development/constructor/courses/FeedbackWidget/node_modules/react/index.js","/Users/cdreek/development/constructor/courses/FeedbackWidget/node_modules/react-dom/client.js","/Users/cdreek/development/constructor/courses/FeedbackWidget/node_modules/axios/index.js"],t):(e=typeof globalThis<"u"?globalThis:e||self,t(e.jsxRuntime_js,e.React,e.ReactDOM,e.axios))})(this,function(e,t,q,W){"use strict";const O="",z={feedback_container:"_feedback_container_1ukn5_1"},F=()=>{const[s,n]=t.useState(""),o=t.useCallback(c=>c.getAttribute&&c.getAttribute("data-feedback-widget")?!1:c.parentElement?o(c.parentElement):!0,[]),i=t.useCallback(c=>{if(o(c.target)){const d=window.getSelection().toString();n(d)}},[o]);return t.useEffect(()=>{const c=window.getSelection().toString();n(c)},[]),t.useEffect(()=>(document.addEventListener("mouseup",i),()=>{document.removeEventListener("mouseup",i)}),[i]),[s,n]},m=function(s){const o=("; "+document.cookie).split("; "+s+"=");if(o.length===2)return o.pop().split(";").shift()},r={feedback_container:"_feedback_container_q10rz_1",feedback_form:"_feedback_form_q10rz_15",info_close:"_info_close_q10rz_21",user_info:"_user_info_q10rz_27",buttons:"_buttons_q10rz_34",feedback__submit:"_feedback__submit_q10rz_39",feedback__remove_selection:"_feedback__remove_selection_q10rz_40",text_selection:"_text_selection_q10rz_74",close_button:"_close_button_q10rz_82",user_error:"_user_error_q10rz_106"},g={success_container:"_success_container_1q5li_1",tick_icon:"_tick_icon_1q5li_12",success_message:"_success_message_1q5li_17"},N=({setShow:s})=>(t.useEffect(()=>{setTimeout(()=>{s(!1)},1e3)},[s]),e.jsxs("div",{className:g.success_container,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",className:g.tick_icon,children:e.jsx("path",{d:"M20.285 2L9 13.567 3.714 8.556 0 12.271l9 8.729L24 4.958z"})}),e.jsx("span",{className:g.success_message,children:"Success! Thank you for the feedback."})]})),T=({handleToggle:s,setShowWidget:n,projectId:o,assigneeId:i,apiUrl:c,issueTypeId:d})=>{const[u,_]=t.useState(""),[A,C]=t.useState(!1),[B,I]=t.useState("anonymous"),[f,w]=t.useState(""),[k,y]=t.useState(""),[l,M]=F(),P=()=>{w(""),y(""),M("")},L=b=>{b.preventDefault(),_(""),f&&l?W.post(c,{fields:{project:{key:o},assignee:{id:i},summary:f,issuetype:{id:d},description:`Page 
 ${window.location.href} 
 
 Feedback 
 ${k} 
 
 Selection 
 ${l}`,customfield_10109:B}},{headers:{Authorization:`Bearer ${m("materials_access")}`}}).then(()=>{C(!0)}).catch(D=>{console.log("Error",D)}):f?l||_("Please provide a text selection!"):_("Please provide a title!")},S=m("momentum_username");return S&&I(S),e.jsx(e.Fragment,{children:A?e.jsx(N,{setShow:n}):e.jsxs("form",{className:r.feedback_form,onSubmit:L,children:[e.jsxs("div",{className:r.info_close,children:[e.jsx("div",{className:r.user_info,children:"Please select a text that you want to give feedback about with your mouse. Only select the important part. It will appear here:"}),e.jsx("button",{type:"button",onClick:s,className:r.close_button,children:"X"})]}),l&&e.jsx("div",{className:r.text_selection,children:l}),u&&e.jsx("div",{className:r.user_error,children:u}),e.jsx("input",{type:"text",placeholder:"*Please provide a title",value:f,onChange:b=>w(b.target.value)}),e.jsx("textarea",{type:"text",placeholder:"Tell us more...",value:k,onChange:b=>y(b.target.value),rows:"5"}),e.jsxs("div",{className:r.buttons,children:[(l||f||k)&&e.jsx("button",{type:"button",className:r.feedback__remove_selection,onClick:P,children:"Reset"}),e.jsx("button",{type:"submit",className:r.feedback__submit,children:"Submit"})]})]})})},h={container:"_container_1cz2b_1",lightning_icon:"_lightning_icon_1cz2b_5"},U=({handleToggle:s})=>e.jsxs("button",{type:"button",onClick:s,className:h.container,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",id:"svg2",viewBox:"0 0 16 16",version:"1.1",className:h.lightning_icon,children:e.jsx("g",{id:"layer1",transform:"translate(0 -1036.4)",children:e.jsx("path",{id:"path2996",d:"m3.4724 8.5186 3.0305-7.0711h6.9448l-5.0192 5.0823h4.1353l-8.1128 9.0914 2.0834-7.1342z",transform:"translate(0 1036.4)",fill:"#ffd500"})})}),"Give Feedback"]}),$=({projectId:s,assigneeId:n,apiUrl:o,issueTypeId:i})=>{const[c,d]=t.useState(!1),u=()=>{d(_=>!_)};return e.jsx("div",{className:z.feedback_container,"data-feedback-widget":!0,children:c?e.jsx(T,{handleToggle:u,setShowWidget:d,projectId:s,assigneeId:n,apiUrl:o,issueTypeId:i}):e.jsx(U,{handleToggle:u})})},a=document.getElementById("feedback-widget-root");console.log("feedbackWidgetRoot loading",a);let p=0;const v=10,E=5e3,x=()=>{if(a){const s=a.getAttribute("data-project-id"),n=a.getAttribute("data-assignee-id"),o=a.getAttribute("data-api-url"),i=a.getAttribute("data-issue-type-id");q.render(e.jsx(t.StrictMode,{children:e.jsx($,{projectId:s,assigneeId:n,apiUrl:o,issueTypeId:i})}),a)}else console.log("feedbackWidgetRoot not found. Retrying in 5 seconds."),p+=1,p<=v?setTimeout(x,E):console.log(`Failed to render widget after ${v} retries.`)};x()});
